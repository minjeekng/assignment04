---
title: "Data Science for Public Policy"
subtitle: "Assignment 04"
author: "Minji Kang - mk2322 and Ziqiao Shan - zs352"
execute:
  warning: false
format:
  html:
    embed-resources: true
---

```{r}
# install readxl package to read excel file, if needed
# install.packages("readxl")

library(readxl)

library(tidyverse)

library(ggplot2)

# Korea Birth Rate (By Province)

birthrate <-
  read_xlsx("data/birthrate.xlsx") 

birthrate <- birthrate |>
  pivot_longer(
    cols = starts_with("20"),
    names_to = "year",
    values_to = "birthrate"
  )

# Korea Housing Price (By Province)

housingprice <-
  read_xlsx("data/housingprice.xlsx") 

housingprice <- housingprice |>
  pivot_longer(
    cols = starts_with("20"),
    names_to = "year",
    values_to = "housingprice"
  )

housingprice <- housingprice |>
  mutate(housingprice = as.numeric(housingprice))

# Korea Working Hours Dataset (By Age Group)

workhour <- read_xlsx("data/workhour.xlsx")

workhour <- workhour |>
  pivot_longer(
    cols = starts_with("20"),
    names_to = "year",
    values_to = "workhour"
  )
```

# First ggplot2 Graph (Bar Chart)

## Breif Dataset Explanation:

The data used in Graph 1 is a 2015 - 2023 dataset that reflects fertility rates for provinces on a website run by South Korean government called the Korean Statistical Information Service (KOSIS).

```{r}
# First ggplot2 Graph (Bar Chart)
# **Need to add a proper subtitle
# **Need to design it later (font size color etc)

# We used abbreviation of provinces' names, instead of full name. The reason is 
#that the province's names are long.

ggplot(birthrate, mapping = aes(x = Province, y = birthrate, fill = year, color = )) +
  geom_col(width = 0.5) +
  labs(title = "Annual Birth Rate by Province in South Kore (2015 - 2023)",
       subtitle = "Urbanized areas show lower fertility rates, but exceptionally,
Sejong(SJG) is a new city but has a high fertility rate.",
       x = "Province",
       y = "Birthrate (%)",
       caption = "Data Source: Korean Statistical Information Service (KOSIS)") +
  theme(
    plot.title = element_text(size = 20),
    plot.subtitle = element_text(size = 8, color = "Dark Blue"),
    legend.title = element_text(size = 13),
    axis.text.x = element_text(size = 5))

```
## Dataset Graph Output Explanation:

Even in South Korean society, where the low birth rate is severe, the gap in fertility rates between regions is widening and the reason for this gap is mainly due to the infrastructure gap. Sejong, the highest birth region found in the graph, was constructed in 2012 when the central government of Korea moved here. This city may have the highest birth rate because of its infrastructure and gathering of people with stable employment. The birth rate is affected by various factors, such as jobs, housing, and education, and it is in Sejong that the three major factors work well. However, although the capital city of Seoul has many jobs, it actually has the highest housing prices, so the low birth rate exists.

## Abbreviations for Each Provinces:
1. Whole country → (Total) Tot.
2. Seoul →	SEO
3. Busan →	BUS
4. Daegu →	DAE
5. Incheon →	INC
6. Gwangju →	GWJ
7. Daejeon →	DJN
8. Ulsan →	ULS
9. Sejong-si →	SJG
10. Gyeonggi-do →	GGD
11. Gangwon-do →	GWD
12. Chungcheongbuk-do →	CCB
13. Chungcheongnam-do →	CCN
14. Jeollabuk-do →	JLB
15. Jeollanam-do →	JLN
16. Gyeongsangbuk-do →	GSB
17. Gyeongsangnam-do →	GSN
18. Jeju →	JEJ

# 2nd ggplot2 Graph (Scatterplot)

## Breif Dataset Explanation:

The data used in Graph 2 are 2015 - 2023 datasets that reflects fertility rates and housing prices for provinces on a website run by South Korean government called the Korean Statistical Information Service (KOSIS).

```{r}
# Second ggplot2 Graph (Scatterplot)

scatterplotdata <- full_join(birthrate, housingprice)

scatterplotdata <- scatterplotdata |>
  filter(Province %in% c("SEO"))

ggplot(scatterplotdata, aes(x = housingprice, y = birthrate)) +
  geom_point(alpha = 0.5, color = "red") +
  geom_smooth(method = "lm", color = "orange") +
  labs(
    title = "Annual Housing Price 
and Birth Rate Relationship 
in Seoul (2015 - 2023)", 
    subtitle = "When looking closely at Seoul,
which had the lowest fertility rate,
it is shown that the higher the house price, the lower the fertility rate.", 
    x = "Housing Price", 
    y = "Birthrate (%)", 
    caption = "Data Source: Korean Statistical Information Service (KOSIS)") + 
  theme_minimal() +
  theme(
    plot.title = element_text(size = 20),
    plot.subtitle = element_text(size = 8, color = "Dark Blue"))

```

# 3rd ggplot2 Graph (Histogram)

```{r}
# Third ggplot2 Graph (Histogram)

# **Need to add a proper subtitle
# **Need to design it later (font size color etc)

ggplot(workhour, mapping = aes(x = workhour, fill = Agegroup)) +
  geom_histogram(binwidth = 0.5) +
  labs(title = "Monthly Working Hours by Age Groups (2015 - 2023)",
       subtitle = "....******need to revise it",
       x = "Work Hours",
       y = "Frequency",
       caption = "Data Source: Korean Statistical Information Service (KOSIS)") +
  theme(
    plot.title = element_text(size = 20),
    plot.subtitle = element_text(size = 8, color = "Dark Blue"),
    legend.title = element_text(size = 13),
    axis.text.x = element_text(size = 5))

```

# 4th ggplot2 Graph (Line Plot)

```{r}

```
