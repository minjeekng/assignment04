---
title: "Data Science for Public Policy"
subtitle: "Assignment 04"
author: "Minji Kang - mk2322 and Ziqiao Shan - zs352"
execute:
  warning: false
format:
  html:
    embed-resources: true
---

```{r}
# install readxl package to read excel file, if needed
# install.packages("readxl")

library(readxl)

library(tidyverse)

library(ggplot2)

# Korea Birth Rate (By Province)

birthrate <-
  read_xlsx("data/birthrate.xlsx") 

birthrate <- birthrate |>
  pivot_longer(
    cols = starts_with("20"),
    names_to = "year",
    values_to = "birthrate"
  )

# Korea Housing Price (By Province)

housingprice <-
  read_xlsx("data/housingprice.xlsx") 

housingprice <- housingprice |>
  pivot_longer(
    cols = starts_with("20"),
    names_to = "year",
    values_to = "housingprice"
  )

housingprice <- housingprice |>
  mutate(housingprice = as.numeric(housingprice))

# Korea Working Hours Dataset (By Age Group)

workhour <- read_xlsx("data/workhour.xlsx")

workhour <- workhour |>
  pivot_longer(
    cols = starts_with("20"),
    names_to = "year",
    values_to = "workhour"
  )
```

# First ggplot2 Graph (Bar Chart)

## Brief Dataset Explanation:

Graph 1 uses data from a 2015-2023 dataset provided by the Korean Statistical Information Service (KOSIS), a government-run website that reports fertility rates for each province.

```{r}
# First ggplot2 Graph (Bar Chart)
# **Need to add a proper subtitle
# **Need to design it later (font size color etc)

# We used abbreviation of provinces' names, instead of full name. The reason is 
#that the province's names are long.

ggplot(birthrate, mapping = aes(x = Province, y = birthrate, fill = year, color = )) +
  geom_col(width = 0.5) +
  labs(title = "Annual Birth Rate by Province in South Korea (2015 - 2023)",
       subtitle = "Urbanized areas show lower fertility rates;however, Sejong (SJG),a newly established city, exhibits an exceptionally high rate.",
       x = "Province",
       y = "Birthrate (%)",
       caption = "Data Source: Korean Statistical Information Service (KOSIS)") +
  theme(
    plot.title = element_text(size = 20),
    plot.subtitle = element_text(size = 8, color = "Dark Blue"),
    legend.title = element_text(size = 13),
    axis.text.x = element_text(size = 5))

```
## Dataset Graph Output Explanation:

Even in South Korea, where low birth rates are a serious concern, regional disparities in fertility rates are widening, primarily due to differences in infrastructure. Sejong—the region with the highest birth rate in our graph—was established in 2012 when the central government relocated there. The city's advanced infrastructure and concentration of residents with stable employment may be key factors driving its high birth rate. While birth rates are influenced by a variety of factors such as jobs, housing, and education, Sejong seems to effectively integrate all three. In contrast, although Seoul offers abundant employment opportunities, its exorbitant housing prices contribute to its lower birth rate.


## Abbreviations for Each Provinces:
1. Whole country → (Total) Tot.
2. Seoul →	SEO
3. Busan →	BUS
4. Daegu →	DAE
5. Incheon →	INC
6. Gwangju →	GWJ
7. Daejeon →	DJN
8. Ulsan →	ULS
9. Sejong-si →	SJG
10. Gyeonggi-do →	GGD
11. Gangwon-do →	GWD
12. Chungcheongbuk-do →	CCB
13. Chungcheongnam-do →	CCN
14. Jeollabuk-do →	JLB
15. Jeollanam-do →	JLN
16. Gyeongsangbuk-do →	GSB
17. Gyeongsangnam-do →	GSN
18. Jeju →	JEJ

# 2nd ggplot2 Graph (Scatterplot)

## Brief Dataset Explanation:

The data used in Graph 2 come from datasets spanning 2015 to 2023 that reflect provincial fertility rates and housing prices, sourced from KOSIS.


```{r}
# Second ggplot2 Graph (Scatterplot)

scatterplotdata <- full_join(birthrate, housingprice)

scatterplotdata <- scatterplotdata |>
  filter(Province %in% c("SEO"))

ggplot(scatterplotdata, aes(x = housingprice, y = birthrate)) +
  geom_point(alpha = 0.5, color = "red") +
  geom_smooth(method = "lm", color = "orange") +
  labs(
    title = "Annual Housing Price 
and Birth Rate Relationship 
in Seoul (2015 - 2023)", 
    subtitle = "A closer look at Seoul—despite having the lowest fertility rate—reveals that higher housing prices correspond with lower birth rates.", 
    x = "Housing Price", 
    y = "Birthrate (%)", 
    caption = "Data Source: Korean Statistical Information Service (KOSIS)") + 
  theme_minimal() +
  theme(
    plot.title = element_text(size = 20),
    plot.subtitle = element_text(size = 8, color = "Dark Blue"))

```
## Dataset Graph Output Explanation:

From the scatter plot, we observe a strong negative correlation between housing prices and birth rate in Seoul. The fitted regression line slopes downward, indicating that higher housing prices are associated with lower birth rates. One possible interpretation is that as housing costs increase, financial constraints or concerns about affordability may lead some families to delay or reduce childbearing. However, it is important to note that correlation does not imply causation. Other factors could also influence birth rates.

# 3rd ggplot2 Graph (Histogram)

## Brief Dataset Explanation:

The data used in Graph 3 come from datasets spanning 2015 to 2023 that capture monthly working hours across various age groups, sourced from KOSIS

```{r}
# Third ggplot2 Graph (Histogram)

# **Need to add a proper subtitle
# **Need to design it later (font size color etc)

ggplot(workhour, mapping = aes(x = workhour, fill = Agegroup)) +
  geom_histogram(binwidth = 0.5) +
  labs(title = "Monthly Working Hours by Age Groups (2015 - 2023)",
       subtitle = "An analysis of monthly working hours by age groups from 2015 to 2023 reveals distinct trends in work patterns, highlighting evolving labor demands and generational differences.",  #subtitle needs to be revised
       x = "Working Hours",
       y = "Frequency",
       caption = "Data Source: Korean Statistical Information Service (KOSIS)") +
  theme(
    plot.title = element_text(size = 20),
    plot.subtitle = element_text(size = 8, color = "Dark Blue"),
    legend.title = element_text(size = 13),
    axis.text.x = element_text(size = 5))

```
## Dataset Graph Output Explanation:

From the histogram, we find that working hours across age groups reveals that individuals aged 29 to 49 work the longest. This trend may help explain Seoul's low fertility rate, as extended working hours can contribute to delayed family planning and lower overall birth rates.

# 4th ggplot2 Graph (Line Plot)

## Breif Dataset Explanation:

The data used in Graph 4 come from a dataset spanning 2016 to 2023 that reflects Seoul's annual household expenditures on private education, sourced from the official KOSIS website.

```{r}
#Due to missing data in year 2025, we use data from 2016 to 2023 in this part
#The line pot reflects the private education expenditures in Seoul from 2016 to 2023
#Seoul's Education Expenditures
seoul_edu <- 
  read_excel("data/seoul_edu.xlsx")

ggplot(seoul_edu, aes(x = Year, y = Expenditures)) +
  geom_line(color = "red", size = 1) +
  geom_point(color = "orange", size = 2) +
  scale_x_continuous(breaks = 2016:2023) +
  labs(
    title = "Private Education Expenditures in Seoul (2016-2023)",
    subtitle = "Annual household expenditures on private education",
    x = "Year",
    y = "Expenditure (billion Won)",
    caption = "Source: Korea Statistical Information Service"
  ) +
  theme_minimal()
```


## Dataset Graph Output Explanation:
The chart shows a generally upward trend in private education expenditures in Seoul from 2016 to 2023. Despite some fluctuations in year 2020 which may be influenced by the outbreak of COVID-19, the overall increase suggests growing demand or greater investment in private education over this period. By 2023, expenditures are noticeably higher than in 2016, indicating that private education remains a significant and possibly expanding sector. However, additional context—such as population changes, policy shifts, or economic factors—would be needed to fully explain the observed trend.

## Summary
Our study investigates the major factors influencing Seoul's fertility rate. Initially, we used a bar chart to compare birth rates across South Korean provinces from 2015 to 2023, revealing that Seoul exhibits the lowest fertility rate. This observation directed our focus to Seoul as our primary research subject. A subsequent scatter plot analysis showed a negative correlation between birth rates and housing prices in Seoul, indicating that higher housing costs may discourage family planning. Additionally, a histogram of monthly working hours by age group revealed that individuals aged 29 to 49—representing the middle-aged cohort—work the longest hours, a factor that could contribute to the low fertility rate. Finally, a line plot demonstrated a steady increase in private educational expenditures over the years. Taken together, our findings suggest that housing prices, extended working hours, and rising private educational expenditures are the three major factors affecting Seoul's fertility rate.
